---
title: Authentication & Security
description: Secure API access and best practices
---

# Authentication & Security

ToughTongue AI uses API tokens (Personal Access Tokens) for authentication. This guide covers how to create, manage, and securely use your API tokens.

## API Tokens

### Creating an API Token

<Steps>
  <Step title="Navigate to Developer Portal">
    Go to [app.toughtongueai.com/developer](https://app.toughtongueai.com/developer?tab=api-keys)
  </Step>
  
  <Step title="Create New Token">
    Click **"Create API Key"** and provide a descriptive name
  </Step>
  
  <Step title="Save Securely">
    Copy the token immediately - it won't be shown again!
  </Step>
</Steps>

<Warning>
  **Security Alert**: Never commit API tokens to version control or expose them in client-side code.
</Warning>

### Using Your Token

Include your token in the `Authorization` header:

```javascript
const response = await fetch('https://api.toughtongueai.com/api/public/scenarios', {
  headers: {
    'Authorization': 'Bearer YOUR_API_TOKEN'
  }
});
```

### Testing Your Token

```bash
curl -X POST https://api.toughtongueai.com/api/public/test \
  -H "Authorization: Bearer YOUR_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"message": "test"}'
```

## Security Best Practices

<AccordionGroup>
  <Accordion title="1. Never Expose Tokens Client-Side" icon="shield-exclamation">
    ❌ **Bad**: Embedding token in frontend JavaScript
    ```javascript
    // DON'T DO THIS
    const API_TOKEN = 'sk_live_abc123...';
    fetch('https://api.toughtongueai.com/...', {
      headers: { 'Authorization': `Bearer ${API_TOKEN}` }
    });
    ```
    
    ✅ **Good**: Proxy through your backend
    ```javascript
    // Frontend: Call your own API
    fetch('/api/analyze', {
      method: 'POST',
      body: JSON.stringify({ session_id })
    });
    
    // Backend: Use token server-side
    app.post('/api/analyze', async (req, res) => {
      const response = await fetch('https://api.toughtongueai.com/...', {
        headers: { 'Authorization': `Bearer ${process.env.TTAI_TOKEN}` }
      });
      res.json(await response.json());
    });
    ```
  </Accordion>
  
  <Accordion title="2. Use Environment Variables" icon="gear">
    Store tokens in environment variables, never in code:
    
    ```bash
    # .env
    TTAI_TOKEN=your_token_here
    ```
    
    ```javascript
    // Load from environment
    const apiToken = process.env.TTAI_TOKEN;
    ```
    
    Add `.env` to `.gitignore`:
    ```
    .env
    .env.local
    *.env
    ```
  </Accordion>
  
  <Accordion title="3. Rotate Tokens Regularly" icon="rotate">
    - Create new tokens periodically
    - Delete old/unused tokens
    - Update tokens if compromised immediately
  </Accordion>
  
  <Accordion title="4. Use Least Privilege" icon="user-lock">
    - Create separate tokens for different environments (dev, staging, prod)
    - Use organization-scoped tokens when possible
    - Revoke tokens when no longer needed
  </Accordion>
  
  <Accordion title="5. Monitor Usage" icon="chart-line">
    - Check API usage regularly
    - Set up alerts for unusual activity
    - Review access logs periodically
  </Accordion>
</AccordionGroup>

## Organization Management

For team and enterprise use:

### Organization Context

API calls can be scoped to an organization:

```javascript
const response = await fetch('https://api.toughtongueai.com/api/public/scenarios', {
  headers: {
    'Authorization': 'Bearer YOUR_API_TOKEN',
    'X-Organization-ID': 'org_123'
  }
});
```

### Permissions

Control who can access scenarios and sessions:

```json
{
  "permissions": [
    {
      "user_id": "user_123",
      "role": "editor"
    },
    {
      "org_id": "org_456",
      "role": "viewer"
    }
  ]
}
```

## Scenario Access Tokens

For public scenarios, generate short-lived access tokens:

```javascript
const response = await fetch(
  'https://api.toughtongueai.com/api/public/scenario-access-token',
  {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_TOKEN',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      scenario_id: 'scenario_123',
      expires_in: 3600  // 1 hour
    })
  }
);

const { access_token } = await response.json();
```

Use this token for client-side embedding without exposing your main API token.

## Rate Limiting

API endpoints are rate-limited to ensure fair usage:

- **Standard tier**: 100 requests/minute
- **Pro tier**: 1000 requests/minute
- **Enterprise**: Custom limits

Handle rate limits gracefully:

```javascript
async function fetchWithRetry(url, options, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    const response = await fetch(url, options);
    
    if (response.status === 429) {
      // Rate limited - wait and retry
      const retryAfter = response.headers.get('Retry-After') || 60;
      await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));
      continue;
    }
    
    return response;
  }
  
  throw new Error('Max retries exceeded');
}
```

## CORS & Domain Restrictions

Configure allowed domains for iframe embedding:

```json
{
  "scenario_id": "abc123",
  "allowed_domains": [
    "https://yourdomain.com",
    "https://app.yourdomain.com"
  ]
}
```

## Security Checklist

<Check>Store tokens in environment variables</Check>
<Check>Use HTTPS for all API calls</Check>
<Check>Proxy API calls through your backend</Check>
<Check>Verify iframe message origins</Check>
<Check>Rotate tokens regularly</Check>
<Check>Monitor API usage and logs</Check>
<Check>Use organization-scoped tokens for teams</Check>
<Check>Implement rate limit handling</Check>
<Check>Add error logging and alerting</Check>
<Check>Review security regularly</Check>

## Example: Secure Backend Proxy

<Tabs>
  <Tab title="Node.js/Express">
    ```javascript
    import express from 'express';
    
    const app = express();
    app.use(express.json());
    
    const TTAI_TOKEN = process.env.TTAI_TOKEN;
    
    // Proxy analyze endpoint
    app.post('/api/analyze', async (req, res) => {
      try {
        const { session_id } = req.body;
        
        const response = await fetch(
          'https://api.toughtongueai.com/api/public/sessions/analyze',
          {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${TTAI_TOKEN}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ session_id })
          }
        );
        
        const data = await response.json();
        res.json(data);
      } catch (error) {
        res.status(500).json({ error: error.message });
      }
    });
    ```
  </Tab>
  
  <Tab title="Python/Flask">
    ```python
    from flask import Flask, request, jsonify
    import requests
    import os
    
    app = Flask(__name__)
    TTAI_TOKEN = os.environ.get('TTAI_TOKEN')
    
    @app.route('/api/analyze', methods=['POST'])
    def analyze():
        try:
            session_id = request.json['session_id']
            
            response = requests.post(
                'https://api.toughtongueai.com/api/public/sessions/analyze',
                headers={
                    'Authorization': f'Bearer {TTAI_TOKEN}',
                    'Content-Type': 'application/json'
                },
                json={'session_id': session_id}
            )
            
            return jsonify(response.json())
        except Exception as e:
            return jsonify({'error': str(e)}), 500
    ```
  </Tab>
</Tabs>

## Next Steps

<CardGroup cols={2}>
  <Card title="API Reference" href="/api-reference/overview">
    Explore all API endpoints
  </Card>
  <Card title="Starter Templates" href="/starters/overview">
    See secure implementation examples
  </Card>
</CardGroup>
